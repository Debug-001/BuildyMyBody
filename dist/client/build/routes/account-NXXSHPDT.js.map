{
  "version": 3,
  "sources": ["../../../../app/routes/account.jsx"],
  "sourcesContent": ["import { Form, NavLink, Outlet, useLoaderData } from '@remix-run/react';\nimport { json, redirect } from '@shopify/remix-oxygen';\nimport Footer from '~/Components/Footer';\nimport Navbar from '~/Components/Navbar';\n\nexport function shouldRevalidate() {\n  return true;\n}\n\nexport async function loader({ request, context }) {\n  const { session, storefront } = context;\n  const { pathname } = new URL(request.url);\n  const customerAccessToken = await session.get('customerAccessToken');\n  const isLoggedIn = Boolean(customerAccessToken?.accessToken);\n  const isAccountHome = pathname === '/account' || pathname === '/account/';\n  const isPrivateRoute =\n    /^\\/account\\/(orders|orders\\/.*|profile|addresses|addresses\\/.*)$/.test(\n      pathname,\n    );\n\n  if (!isLoggedIn) {\n    if (isPrivateRoute || isAccountHome) {\n      session.unset('customerAccessToken');\n      return redirect('/account/login', {\n        headers: {\n          'Set-Cookie': await session.commit(),\n        },\n      });\n    } else {\n      // public subroute such as /account/login...\n      return json({\n        isLoggedIn: false,\n        isAccountHome,\n        isPrivateRoute,\n        customer: null,\n      });\n    }\n  } else {\n    // loggedIn, default redirect to the orders page\n    if (isAccountHome) {\n      return redirect('/account/orders');\n    }\n  }\n\n  try {\n    const { customer } = await storefront.query(CUSTOMER_QUERY, {\n      variables: {\n        customerAccessToken: customerAccessToken.accessToken,\n        country: storefront.i18n.country,\n        language: storefront.i18n.language,\n      },\n      cache: storefront.CacheNone(),\n    });\n\n    if (!customer) {\n      throw new Error('Customer not found');\n    }\n\n    return json(\n      { isLoggedIn, isPrivateRoute, isAccountHome, customer },\n      {\n        headers: {\n          'Cache-Control': 'no-cache, no-store, must-revalidate',\n        },\n      },\n    );\n  } catch (error) {\n    // eslint-disable-next-line no-console\n    console.error('There was a problem loading account', error);\n    session.unset('customerAccessToken');\n    return redirect('/account/login', {\n      headers: {\n        'Set-Cookie': await session.commit(),\n      },\n    });\n  }\n}\n\nexport default function Acccount() {\n  const { customer, isPrivateRoute, isAccountHome } = useLoaderData();\n\n  if (!isPrivateRoute && !isAccountHome) {\n    return <Outlet context={{ customer }} />;\n  }\n\n  return (\n    <AccountLayout customer={customer}>\n      <br />\n      <br />\n      <Outlet context={{ customer }} />\n    </AccountLayout>\n  );\n}\n\nfunction AccountLayout({ customer, children }) {\n  const firstName = customer?.firstName;\n  const lastName = customer?.lastName;\n  let heading;\n  if (firstName && lastName) {\n    heading = `Welcome, ${firstName} ${lastName}`;\n  } else if (firstName) {\n    heading = `Welcome, ${firstName}`;\n  } else {\n    heading = 'Welcome to your account.';\n  }\n  return (\n    <>\n      <Navbar />\n      <div className=\"account pt-5 pb-5\">\n        <div\n          className=\"d-flex justify-content-center mb-5\"\n          style={{ flexDirection: 'column', alignItems: 'center' }}\n        >\n          <h1\n            className=\"font-weight-bold custom-heading3\"\n            style={{ color: '#ff2828' }}\n          >\n            <em>{heading}</em>\n          </h1>\n          <hr className=\"h1-hr\" />\n        </div>\n        <br />\n        <AcccountMenu />\n        {children}\n      </div>\n      <Footer />\n    </>\n  );\n}\n\nfunction AcccountMenu() {\n  function isActiveStyle({ isActive, isPending }) {\n    return {\n      fontWeight: isActive ? 'bold' : '',\n      color: isPending ? 'grey' : 'black',\n    };\n  }\n  return (\n    <>\n      <div className=\"account_menu container\">\n        <div className=\"card-acc  \">\n          <div className='row'>\n            <div className=\"col-lg-3 col-md-6 text-lg-center\" style={{ fontSize: '1.3rem' }}>\n              <NavLink to=\"/account/orders\" style={isActiveStyle}>\n                My Orders\n              </NavLink>\n            </div>\n            <div className=\"col-lg-3 col-md-6 mt-4 mt-lg-0 mt-md-0 text-lg-center\" style={{ fontSize: '1.3rem' }}>\n              <NavLink to=\"/account/profile\" style={isActiveStyle}>\n                Profile\n              </NavLink>\n            </div>\n            <div className=\"col-lg-3 col-md-6 mt-4 mt-lg-0 text-lg-center\" style={{ fontSize: '1.3rem' }}>\n              <NavLink to=\"/account/addresses\" style={isActiveStyle}>\n                Saved Addresses\n              </NavLink>\n            </div>\n            <div className=\"col-lg-3 col-md-6 mt-4 mt-lg-0 text-lg-center\" style={{ fontSize: '1.2rem' }}>\n              <Logout />\n            </div>\n          </div>\n        </div>\n      </div>\n    </>\n  );\n}\n\nfunction Logout() {\n  return (\n    <>\n      <Form className=\"account-logout\" method=\"POST\" action=\"/account/logout\">\n        &nbsp;\n        <button type=\"submit\" className=\"btn-logout\">\n          Sign out\n        </button>\n      </Form>\n    </>\n  );\n}\n\nexport const CUSTOMER_FRAGMENT = `#graphql\n  fragment Customer on Customer {\n    acceptsMarketing\n    addresses(first: 6) {\n      nodes {\n        ...Address\n      }\n    }\n    defaultAddress {\n      ...Address\n    }\n    email\n    firstName\n    lastName\n    numberOfOrders\n    phone\n  }\n  fragment Address on MailingAddress {\n    id\n    formatted\n    firstName\n    lastName\n    company\n    address1\n    address2\n    country\n    province\n    city\n    zip\n    phone\n  }\n`;\n\n// NOTE: https://shopify.dev/docs/api/storefront/latest/queries/customer\nconst CUSTOMER_QUERY = `#graphql\n  query Customer(\n    $customerAccessToken: String!\n    $country: CountryCode\n    $language: LanguageCode\n  ) @inContext(country: $country, language: $language) {\n    customer(customerAccessToken: $customerAccessToken) {\n      ...Customer\n    }\n  }\n  ${CUSTOMER_FRAGMENT}\n`;"],
  "mappings": "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",
  "names": []
}
